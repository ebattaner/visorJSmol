<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<title>JSmol - Polinucleótidos</title>

<!-- Ajusta esta ruta si tu carpeta no se llama exactamente "JSmol" -->
<script src="../JSmol/JSmol.min.js"></script>

<style>
  :root { --gap: 16px; --left-w: 700px; --left-h: 600px; }

  * { box-sizing: border-box; }
  body { margin: 0; font-family: system-ui, Segoe UI, Roboto, Arial, sans-serif; background: #fafafa; color: #222; }

  /* === CLAVE: fijar el panel izquierdo (visor) === */
  #viewerWrap {
    position: fixed;          /* anclado */
    top: var(--gap);
    left: var(--gap);
    width: var(--left-w);     /* mismo ancho que estabas usando */
    background: #fff; border: 1px solid #ddd; border-radius: 10px; padding: 12px;
    z-index: 1;
  }

  /* === CLAVE: el visor ocupa el alto deseado === */
  #viewer {
    width: 100%;
    height: var(--left-h);    /* alto grande del visor */
    border: 1px solid #999; border-radius: 8px; background: #fff;
  }

  /* Panel derecho: lo desplazamos a la derecha del visor fijo */
  .panel {
    background: #fff; border: 1px solid #ddd; border-radius: 10px; padding: 12px;
    margin-top: var(--gap);
    margin-left: calc(var(--left-w) + (var(--gap) * 2)); /* deja hueco para el visor fijo */
    margin-right: var(--gap);
    min-height: calc(var(--left-h) + 2*var(--gap)); /* opcional, para arrancar a la par */
  }

  /* ya no usamos el grid como layout, pero mantenemos el contenedor para el padding superior */
  .layout { padding-top: 0; }

  h2, h3 { margin: 8px 0 6px; }
  .bloque { padding: 10px 0; border-top: 1px dashed #e5e7eb; }
  .bloque:first-of-type { border-top: none; }
  .texto-exp { color:#555; margin: 6px 0 10px; }
  button { padding: 8px 12px; border: 1px solid #ccc; background: #f7f7f7; border-radius: 8px; cursor: pointer; }
  button:hover { background: #eee; }
  label { cursor: pointer; margin-right: 14px; }
  .grupo-radios { margin-top: 8px; }

  /* Responsive (opcional): en pantallas estrechas, el visor deja de ser fijo y va arriba */
  @media (max-width: 980px){
    #viewerWrap { position: static; width: auto; margin: var(--gap); }
    .panel { margin: var(--gap); }
    #viewer { height: 380px; }
  }
</style>

<script>
  var jmolApplet0;
  var currentMol = null; // nombre del archivo actualmente cargado
  Jmol.setDocument(0);

  function visorSize() {
    // Como el visor ahora tiene height fijo por CSS, usamos el ancho disponible del contenedor
    var el = document.getElementById('viewer');
    var w = el ? el.clientWidth : 600;
    return Math.max(400, Math.min(800, w));
  }

  var Info = {
    width: visorSize(),
    height: visorSize(),  // JSmol se acomodará; el alto visual lo manda el CSS de #viewer
    debug: false,
    color: "white",
    use: "HTML5",
    j2sPath: "../JSmol/j2s",
    disableInitialConsole: true,
    script: "background white; set antialiasDisplay true;"
  };

  function initJSmol() {
    var s = visorSize();
    Info.width = s; Info.height = s;
    jmolApplet0 = Jmol.getApplet("jmolApplet0", Info);
    document.getElementById("viewer").innerHTML = Jmol.getAppletHtml(jmolApplet0);
  }

  window.addEventListener('resize', function() {
    if (!jmolApplet0) return;
    var s = visorSize();
    Jmol.resizeApplet(jmolApplet0, s, s);
  });

  function cmd(s) { Jmol.script(jmolApplet0, s); }

  // Representaciones
  function applyBallStick() {
    cmd("select all; cartoons off; ribbons off; backbone off; wireframe 0.20; spacefill 20%; color cpk; center all; zoom 120;");
  }
  function applySpacefill() {
    cmd("select all; cartoons off; ribbons off; backbone off; wireframe off; spacefill 100%; color cpk; center all; zoom 120;");
  }

  // Cargar molécula y aplicar representación (ballstick por defecto si no se indica otra)
  function loadMolecule(molName, repr) {
    currentMol = molName;
    cmd('load "' + molName + '";'); // comillas por si hay rutas con guiones
    if (repr === "spacefill") applySpacefill(); else applyBallStick();

    // Marcar radios de su bloque según la representación aplicada (si existen)
    var ridBall = document.getElementById("r-" + molName + "-ball");
    var ridSpace = document.getElementById("r-" + molName + "-space");
    if (ridBall && ridSpace) {
      if (repr === "spacefill") { ridSpace.checked = true; }
      else { ridBall.checked = true; }
    }
  }

  // Cambia representación para la molécula indicada (si no está cargada, la carga primero)
  function setRepresentationFor(molName, repr) {
    if (currentMol !== molName) {
      loadMolecule(molName, repr);
      return;
    }
    if (repr === "spacefill") applySpacefill(); else applyBallStick();
  }
</script>

<script>function jrun(s){ Jmol.script(jmolApplet0, s); }</script>

</head>

<body onload="initJSmol()">
  <div class="layout">
    <!-- Panel izquierdo: visor (FIJO) -->
    <div id="viewerWrap">
      <h3 style="margin:4px 0 10px;">Visor</h3>
      <div id="viewer"></div>
    </div>

    <!-- Panel derecho: texto + controles por molécula (SCROLL) -->
    <div class="panel">




<a name="inicio"></a>
<hr /><p><center>
<font face="Arial"><A HREF="Distr_Acidos_Nucleicos.html" ><B>&Iacute;ndice Ácidos Nucleicos</B></A></font>
</center>
<p>
<hr />
<P align="center"><font size="+2"><B>Polinucle&oacute;tidos</B></font></center>
<br /><br />
<p>
<p>
<script type="text/javascript"><!--
jmolSetTarget(1)
//-->
</script>


<p align="justify">Los nucleótidos pueden unirse a través de un enlace <B>fosfodiéster</B>. Este enlace es el característico de los ácidos nucleicos de la misma manera que el enlace peptídico lo es las proteínas. En la representación de polinucleótidos es frecuente, al igual que en el caso de las proteínas, no representar los átomos de hidrógeno. Tomaremos como ejemplo un <b>tetranucleótido</b> (en rigor, tetradesoxinucleótido)</p>

<center>
  <button type="button"
    onclick="jrun('load &quot;../pdb/4NUC.pdb&quot;; \
                   set antialiasDisplay on; \
                   ')">
    <b>Polinucleótido</b>
  </button>
</center>

<p align="justify">Al tratarse de desoxinucleótidos, pueden estar fosforilados en 3' y 5'.

<div style="max-width:48rem;margin:0 auto;">
  <fieldset style="border:0;margin:8px 0;padding:0">
    <label style="display:block;margin:.35rem 0;">
      <input type="radio" name="4nuc-steps"
             onchange="jrun('color labels black; restrict 3;')">
	El primer nucleótido aparece fosforilado en la posición 5'. El grupo hidroxi en 3' establece un enlace fosfodiéster con
    </label>

<label style="display:block;margin:.35rem 0;">
      <input type="radio" name="4nuc-steps"
             onchange="jrun('restrict 3,4; wireframe 50; spacefill 100; select atomno=8; label 3´;select atomno = 26; label 5´;')">
	el grupo en 5' del siguiente nucleótido, y  de la misma manera éste se une
    </label>

<label style="display:block;margin:.35rem 0;">
      <input type="radio" name="4nuc-steps"
             onchange="jrun('restrict 3,4,5; wireframe 50; spacefill 100; select atomno=29; label 3´; select atomno=45; label 5´;')">
	al tercer nucleótido, que a su vez se une al
	</label>

<label style="display:block;margin:.35rem 0;">
      <input type="radio" name="4nuc-steps"
             onchange="jrun('restrict 3,4,5,6; wireframe 50; spacefill 100; select atomno=48; label 3´; select atomno=67; label 5´; ')">
	cuarto nucleótido.
	</label>


<p align=justify>Tenemos entonces en pantalla  un <B>tetranucleótido</B>. Convencionalmente  los polinucleótidos se numeran desde el residuo 5' terminal, que es aquel que tiene un 5'-OH libre (extremo 5'):</p>

<label style="display:block;margin:.35rem 0;">
      <input type="radio" name="4nuc-steps"
             onchange="jrun('select atomno=5; label Extremo 5´;select atomno=70; label Extremo 3`;')">
	Extremos
	</label>
</fieldset>
</div>

<p align= justify> el cual muy frecuentemente aparece esterificado a un fosfato o polifosfato, como en este caso. En el extremo opuesto de la molécula hay un grupo 3'-OH libre: el Extremo 3'. En el ejemplo el primer nucleótido es A, el segundo C, el tercero G y el cuarto C; la secuencia del polinucleótido será la siguiente:


	</label>
<p align="justify">

<p align="center"><B> 5'- ACGC - 3'</B><p>
<p align="justify">O simplemente, ACGC. Hemos de tener en cuenta que el grado de polimerización de los polinucleótidos llega a ser altísimo, con cientos de millones de nucleótidos en los DNAs genómicos. Veamos, por ejemplo, el DNA de un <i>nucleosoma</i>, pero teniendo en cuenta que un genoma eucariótico puede contar con millones de nucleosomas:</p>

<center>
  <button type="button"
    onclick="jrun('load &quot;../pdb/1aoi.pdb&quot;; \
                   set antialiasDisplay on; \
                   restrict nucleic;')">
    <b>DNA de nucleosoma</b>
  </button>
</center>

<br /><br />

<hr />

			<center><table border=0 WIDTH=90%><tr>
				<td align=center width=30%>
				<A HREF="pgJSmol_101.html" ><B>Anterior: Bases, Nucleósidos y Nucleótidos</B></A>
				</td> 
				<td align=center width=30%>
				<A HREF="#inicio" ><B>Inicio</B></A>
					
				</td>
				<td align=center width=30%>

				<A HREF="pgJSmol_103.html" ><B>Siguiente: DNA</B></A>					
				</td>

			</tr></table></center>








				</font>

						
			</div>
		</form>
	</body>

	

</html>
